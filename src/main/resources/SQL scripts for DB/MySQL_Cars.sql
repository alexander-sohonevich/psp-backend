/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 14.1 		*/
/*  Created On : 19-Nov-2019 9:22:27 PM 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */

SET FOREIGN_KEY_CHECKS=0
; 
/* Drop Tables */

DROP TABLE IF EXISTS `AUTO` CASCADE
;

DROP TABLE IF EXISTS `BODY` CASCADE
;

DROP TABLE IF EXISTS `CAR_STATUS` CASCADE
;

DROP TABLE IF EXISTS `ORDERED_CARS` CASCADE
;

DROP TABLE IF EXISTS `SOLD_CARS` CASCADE
;

DROP TABLE IF EXISTS `SYSTEMS` CASCADE
;

DROP TABLE IF EXISTS `TRANSMISSION` CASCADE
;

DROP TABLE IF EXISTS `USERS` CASCADE
;

/* Create Tables */

CREATE TABLE `AUTO`
(
	`BRAND` VARCHAR(50) NOT NULL,
	`MODEL` VARCHAR(50) NOT NULL,
	`YEAR_OF_ISSUE` VARCHAR(50) NOT NULL,
	`COST` DECIMAL(15,2) NOT NULL,
	`VIN_CODE` VARCHAR(18) NOT NULL,
	CONSTRAINT `PK_AUTO` PRIMARY KEY (`VIN_CODE` ASC)
)

;

CREATE TABLE `BODY`
(
	`VIN_CODE` VARCHAR(18) NOT NULL,
	`BODY_TYPE` VARCHAR(50) NOT NULL,
	`BODY_COLOR` VARCHAR(50) NOT NULL,
	`NUMBER_OF_DOORS` INT NOT NULL
)

;

CREATE TABLE `CAR_STATUS`
(
	`VIN_CODE` VARCHAR(18) NOT NULL,
	`CAR_STATUS` VARCHAR(50) NOT NULL
)

;

CREATE TABLE `ORDERED_CARS`
(
	`VIN_CODE` VARCHAR(18) NOT NULL,
	`BUYER_NAME` VARCHAR(50) NOT NULL,
	`BUYER_SURNAME` VARCHAR(50) NOT NULL,
	`BUYER_PHONE` VARCHAR(15) NOT NULL
)

;

CREATE TABLE `SOLD_CARS`
(
	`VIN_CODE` VARCHAR(18) NOT NULL,
	`BUYER_NAME` VARCHAR(50) NOT NULL,
	`BUYER_SURNAME` VARCHAR(50) NOT NULL,
	`BUYER_ID` VARCHAR(50) NOT NULL
)

;

CREATE TABLE `SYSTEMS`
(
	`VIN_CODE` VARCHAR(18) NOT NULL,
	`SALON` VARCHAR(50) NOT NULL,
	`SALON_COLOR` VARCHAR(50) NOT NULL,
	`MUTLIMEDIA_SYSTEM` VARCHAR(50) NOT NULL
)

;

CREATE TABLE `TRANSMISSION`
(
	`VIN_CODE` VARCHAR(18) NOT NULL,
	`TRANSMISSION` VARCHAR(50) NOT NULL,
	`WHEEL_DIAMETER` DECIMAL(2,1) NOT NULL
)

;

CREATE TABLE `USERS`
(
	`LOGIN` VARCHAR(50) NOT NULL,
	`PASSWORD` VARCHAR(65) NOT NULL,
	`USER_ROLE` VARCHAR(15) NOT NULL
)

;

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `BODY` 
 ADD INDEX `IXFK_BODY_AUTO` (`VIN_CODE` ASC)
;

ALTER TABLE `CAR_STATUS` 
 ADD INDEX `IXFK_CAR_STATUS_AUTO` (`VIN_CODE` ASC)
;

ALTER TABLE `ORDERED_CARS` 
 ADD INDEX `IXFK_ORDERED_CARS_AUTO` (`VIN_CODE` ASC)
;

ALTER TABLE `SOLD_CARS` 
 ADD INDEX `IXFK_SOLD_CARS_AUTO` (`VIN_CODE` ASC)
;

ALTER TABLE `SYSTEMS` 
 ADD INDEX `IXFK_SYSTEMS_AUTO` (`VIN_CODE` ASC)
;

ALTER TABLE `TRANSMISSION` 
 ADD INDEX `IXFK_TRANSMISSION_AUTO` (`VIN_CODE` ASC)
;

/* Create Foreign Key Constraints */

ALTER TABLE `BODY` 
 ADD CONSTRAINT `FK_BODY_AUTO`
	FOREIGN KEY (`VIN_CODE`) REFERENCES `AUTO` (`VIN_CODE`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `CAR_STATUS` 
 ADD CONSTRAINT `FK_CAR_STATUS_AUTO`
	FOREIGN KEY (`VIN_CODE`) REFERENCES `AUTO` (`VIN_CODE`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `ORDERED_CARS` 
 ADD CONSTRAINT `FK_ORDERED_CARS_AUTO`
	FOREIGN KEY (`VIN_CODE`) REFERENCES `AUTO` (`VIN_CODE`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `SOLD_CARS` 
 ADD CONSTRAINT `FK_SOLD_CARS_AUTO`
	FOREIGN KEY (`VIN_CODE`) REFERENCES `AUTO` (`VIN_CODE`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `SYSTEMS` 
 ADD CONSTRAINT `FK_SYSTEMS_AUTO`
	FOREIGN KEY (`VIN_CODE`) REFERENCES `AUTO` (`VIN_CODE`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `TRANSMISSION` 
 ADD CONSTRAINT `FK_TRANSMISSION_AUTO`
	FOREIGN KEY (`VIN_CODE`) REFERENCES `AUTO` (`VIN_CODE`) ON DELETE Restrict ON UPDATE Restrict
;

SET FOREIGN_KEY_CHECKS=1
; 
